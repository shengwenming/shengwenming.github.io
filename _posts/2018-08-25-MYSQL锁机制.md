---
layout:     post
title:      MYSQL锁机制
subtitle:
date:       2018-08-25
author:     SWM
header-img: img/back.jpg
catalog: true
tags:
    - MYSQL
    

---


##概述
    

    数据库锁机制是数据库为了保证数据的一致性，从而使各种共享资源在被并发访问变得有序所设计的一种规则，对于任何一种数据库来说，都需要有相应的锁定机制。

    MYSQL数据库由于其自身的架构特点，存在多种数据存储引擎，每种引擎由于各自的特点，存在各种为特定场景设计所优化的锁机制，所以各存储引擎的锁机制也有较大区别
    
    MYSQL各存储引擎使用了三中类型的锁定机制：表级锁定、行级锁定和页级锁定
    

###表级锁定

    表级锁定是MYSQL各存储引擎中最大粒度的锁定机制，该锁定机制最大的特点是实现逻辑非常简单，带来的系统负面影响很小，所以获取和释放的速度很快。由于表级锁一次将整个表锁定，所以避免了死锁的问题。当然锁定颗粒度大也会带来负面影响就是资源争用的概率也会最高，致使并发度大打折扣。
    使用表级锁的主要是MYISAM，Memory，CSV等一些非事务性的存储引擎。
    
###行级锁定

    行级锁定最大的特点就是锁定的颗粒度很小，也是目前各大数据库管理软件所实现的最小的颗粒度。由于锁定粒度很小，发生资源争用的概率也会很小，能够给予应用程序尽可能最大的并发处理能力而提高一些需要高并发应用系统的整体性能。
    
    虽然能够在并发处理能力上面有较大的优势，但是频繁获取和释放锁带来的系统消耗也上升了。此外，行级锁定也最容易发生死锁。
    
    使用行级锁定的主要是InnoDB存储引擎。
    
###页级锁定

    页级锁定是MYSQL的一种特定的锁定机制，在其他数据库并不常见，页级锁定的特点是颗粒度介于表级和行级锁定之间，所以获取锁定所需要的资源开销以及所能提供的并发处理能力也同样介于上面二者之间，也会发生死锁。
    
    在数据库实现锁定资源的过程中，随着锁定粒度的变小，锁定相同数据量所需要的内存数量也是越来越多，实现算法也越来越复杂，不过，随着资源锁定粒度的减小，数据库并发性能也会提高，程序请求遇到锁等待的可能性也会随之降低
    
    使用页级锁定主要是BerkeleyDB存储引擎
    
    
    总的来说，MYSQL这三种锁的特性总结如下:
    
    表级锁：开销小，加锁快，不会出现死锁，锁定粒度大，发生冲突的概率最高，并发度最低
    行级锁：开销大，加锁慢，会出现死锁，锁定粒度小，发生冲突的概率最低。并发度最高
    页面锁：开销和加锁时间介于上两者之间，会出现死锁，锁定粒度介于两者之间，并发度一般
    
    适用：从锁的角度来说，表级锁更适合于查询为主，只有少量按索引条件更新数据的应用，如WEB 而行级锁则更适合于有大量按索引条件更新少量不同数据同时又有并发查询的应用
    
        
        
        






    